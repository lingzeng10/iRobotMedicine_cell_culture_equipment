# 工單管理系統 - 自動啟動設置指南

## 已完成項目

### ✅ 1. 創建 .env 文件
已在 `client/.env` 文件中設置：
```
REACT_APP_API_URL=http://localhost:5000/api
HOST=localhost
```

### ✅ 2. 創建自動啟動腳本
已創建 `auto-start-server.bat` 文件，用於任務計劃程序自動啟動。

---

## 設置 Windows 任務計劃程序（自動啟動）

### 步驟 1：打開任務計劃程序
1. 按 `Win + R` 鍵
2. 輸入 `taskschd.msc`
3. 按 Enter

### 步驟 2：創建基本任務
1. 在右側點擊「建立基本工作...」
2. 名稱：`工單管理系統自動啟動`
3. 描述：`開機時自動啟動工單管理系統的前端和後端服務`
4. 點擊「下一步」

### 步驟 3：設置觸發器
1. 選擇「當電腦啟動時」
2. 點擊「下一步」

### 步驟 4：設置操作
1. 選擇「啟動程式」
2. 程式或指令碼：瀏覽並選擇
   ```
   C:\iRobotMedicine_cell culture equipment\auto-start-server.bat
   ```
3. 開始於（選用）：
   ```
   C:\iRobotMedicine_cell culture equipment
   ```
4. 點擊「下一步」

### 步驟 5：完成設置
1. 勾選「當我按一下完成時，開啟這個工作的內容對話方塊」
2. 點擊「完成」

### 步驟 6：進階設置（重要）

在開啟的屬性視窗中進行以下設置：

#### 一般 標籤
- ✅ 勾選「以最高權限執行」
- 設定為：`無論使用者登入與否都要執行`
- ✅ 勾選「不要儲存密碼」

#### 觸發程序 標籤
- 編輯觸發程序
- ✅ 勾選「已啟用」
- 延遲工作時間：`30 秒`（可選，與腳本中的延遲配合）

#### 條件 標籤
- ❌ 取消勾選「只有在電腦使用 AC 電源時才啟動工作」（筆電可保留）
- ❌ 取消勾選「只有在以下網路連線可用時才啟動」（可選）

#### 設定 標籤
- ✅ 勾選「如果要求的工作執行時電腦在睡眠模式，請喚醒電腦」
- ❌ 取消勾選「如果執行中的工作沒有在以下時間內結束，就停止工作」
- 如果工作已在執行中：選擇「不要啟動新的執行個體」

#### 確定
- 點擊「確定」
- 如果提示輸入密碼，輸入您的 Windows 管理員密碼

---

## 驗證設置

### 測試任務計劃
1. 在任務計劃程序中，右鍵點擊「工單管理系統自動啟動」
2. 選擇「執行」
3. 等待 1-2 分鐘
4. 檢查是否有兩個命令視窗出現（前端和後端）
5. 訪問 `http://localhost:3000` 確認服務正常

### 測試開機自動啟動
1. 重啟電腦
2. 等待 1-2 分鐘（讓系統完全啟動）
3. 訪問 `http://localhost:3000` 確認服務自動啟動

---

## 故障排除

### 服務未自動啟動
- 檢查任務計劃程序中的任務是否「已啟用」
- 檢查腳本路徑是否正確
- 檢查是否有管理員權限
- 查看 `startup.log` 文件（在專案根目錄）

### 前端無法連接後端
- 確認 `.env` 文件存在且內容正確
- 確認後端服務正在運行（端口 5000）
- 檢查瀏覽器控制台（F12）查看錯誤訊息

### 端口被占用
- 確認沒有其他程序使用 3000 或 5000 端口
- 重啟電腦後再測試

---

## 手動啟動（如果需要）

如果自動啟動有問題，可以手動執行：
1. 雙擊 `start-server-fixed.bat`
2. 或雙擊 `auto-start-server.bat`

---

## 日誌文件

自動啟動的日誌會記錄在：
```
C:\iRobotMedicine_cell culture equipment\startup.log
```

可以查看此文件了解啟動歷史。

---

## 完成！

設置完成後，您的系統將：
- ✅ 電腦重啟後自動啟動服務
- ✅ 前端自動連接後端
- ✅ 打開瀏覽器即可使用

享受自動化的便利吧！🎉

